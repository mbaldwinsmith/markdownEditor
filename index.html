<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Markdown Editor PWA</title>
    <meta name="description" content="Progressive Web App Markdown editor with Google Drive sync." />
    <meta name="theme-color" content="#1f2937" />
    <meta name="google-oauth-client-id" content="220212893778-a2ja5dvu9tkp700it2819hc6iajvbgiu.apps.googleusercontent.com" />
    <meta name="google-api-key" content="AIzaSyAFSNJgwU29ieU8Mc10RQuIfFt7cG_qd7I" />
    <link rel="manifest" href="manifest.json" />
    <link rel="icon" type="image/svg+xml" href="icons/icon-192.svg" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header>
      <div class="inner">
        <h1>Markdown Editor PWA</h1>
        <nav class="toolbar" aria-label="Markdown formatting">
          <button type="button" data-action="bold" aria-label="Bold">B</button>
          <button type="button" data-action="italic" aria-label="Italic"><em>I</em></button>
          <button type="button" data-action="heading-1" aria-label="Heading level 1">H1</button>
          <button type="button" data-action="heading-2" aria-label="Heading level 2">H2</button>
          <button type="button" data-action="heading-3" aria-label="Heading level 3">H3</button>
          <button type="button" data-action="link" aria-label="Insert link">Link</button>
          <button type="button" data-action="image" aria-label="Insert image">Image</button>
          <button type="button" data-action="ordered-list" aria-label="Ordered list">1.</button>
          <button type="button" data-action="unordered-list" aria-label="Unordered list">•</button>
          <button type="button" data-action="table" aria-label="Insert table">Table</button>
          <button type="button" data-action="horizontal-rule" aria-label="Insert horizontal rule">HR</button>
        </nav>
        <div class="toolbar" aria-label="Google Drive actions">
          <button type="button" class="secondary-button" id="drive-sign-in">Sign in</button>
          <button type="button" class="secondary-button" id="drive-sign-out" hidden>Sign out</button>
          <button type="button" class="secondary-button" id="drive-open" disabled>Open</button>
          <button type="button" class="primary" id="drive-save" disabled>Save</button>
          <button type="button" class="secondary-button" id="drive-save-as" disabled>Save as</button>
        </div>
      </div>
    </header>
    <main>
      <div class="editor-container">
        <div class="editor-wrapper">
          <div class="editor-surface">
            <div
              id="markdown-input"
              class="editor"
              contenteditable="true"
              role="textbox"
              aria-label="Markdown input"
              spellcheck="true"
            ></div>
          </div>
        </div>
        <div class="status-bar">
          <div>
            <span>Words: <strong id="word-count">0</strong></span>
            <span>Characters: <strong id="char-count">0</strong></span>
          </div>
          <div>
            <span class="file-indicator" id="current-file">Untitled.md</span>
            <span id="drive-status"></span>
          </div>
        </div>
        <div id="status-message" role="status" aria-live="polite"></div>
      </div>
    </main>

    <div id="drive-dialog" role="dialog" aria-modal="true" aria-labelledby="drive-dialog-title">
      <div class="dialog-content">
        <div class="dialog-header">
          <h2 id="drive-dialog-title">Google Drive</h2>
          <button type="button" id="drive-dialog-close" aria-label="Close dialog">×</button>
        </div>
        <div class="dialog-body">
          <div id="drive-alert" class="alert" hidden></div>
          <p id="drive-config-status" class="dialog-description">
            Update the <code>google-oauth-client-id</code> meta tag in <code>index.html</code> with your OAuth client ID to enable
            Drive sync.
          </p>
          <div class="toolbar">
            <button type="button" id="drive-refresh-files" class="secondary-button">Refresh files</button>
          </div>
          <div class="drive-files" id="drive-files" hidden>
            <table>
              <thead>
                <tr>
                  <th>File</th>
                  <th>Modified</th>
                </tr>
              </thead>
              <tbody id="drive-files-body"></tbody>
            </table>
          </div>
        </div>
        <div class="dialog-footer">
          <button type="button" id="drive-dialog-cancel">Close</button>
        </div>
      </div>
    </div>

    <script src="app.js" defer></script>
    <script
      defer
      src="https://accounts.google.com/gsi/client"
      onload="onGoogleAccountsLoaded()"
      onerror="console.error('Failed to load Google Identity Services script');"
    ></script>
    <script defer src="https://apis.google.com/js/api.js?onload=onGapiLoaded"></script>
  </body>
</html>
