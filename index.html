<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Mark's Markdown Editor</title>
    <meta name="description" content="Progressive Web App Markdown editor with Google Drive sync." />
    <meta name="theme-color" content="#1f2937" />
    <meta name="google-oauth-client-id" content="220212893778-a2ja5dvu9tkp700it2819hc6iajvbgiu.apps.googleusercontent.com" />
    <link rel="manifest" href="manifest.json" />
    <link rel="icon" type="image/svg+xml" href="icons/icon-192.svg" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header>
      <div class="inner">
        <div class="app-brand">
          <span class="brand-mark" aria-hidden="true">
            <svg viewBox="0 0 32 32" role="presentation">
              <defs>
                <linearGradient id="brand-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                  <stop offset="0%" stop-color="#38bdf8" />
                  <stop offset="100%" stop-color="#0ea5e9" />
                </linearGradient>
              </defs>
              <rect x="2" y="2" width="28" height="28" rx="8" fill="url(#brand-gradient)" />
              <path
                d="M11 22.5V9.5L16 18l5-8.5v13"
                fill="none"
                stroke="#0f172a"
                stroke-width="2.4"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </span>
          <h1>Mark's Markdown Editor</h1>
        </div>
        <div class="toolbar-row">
          <div class="toolbar toolbar-surface formatting" role="toolbar" aria-label="Markdown formatting">
            <button type="button" class="icon-button" data-action="bold" aria-label="Bold">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path d="M7 4.75h1.75v14.5H7z" fill="currentColor" />
                <path d="M8.75 4.75H13a3.25 3.25 0 110 6.5H8.75z" fill="currentColor" />
                <path d="M8.75 11.25H13.5a3.25 3.25 0 110 6.5H8.75z" fill="currentColor" />
              </svg>
            </button>
            <button type="button" class="icon-button" data-action="italic" aria-label="Italic">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M11 5.5h8M7 18.5h8M15 5.5l-4 13"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.6"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
            <button type="button" class="icon-button heading-button" data-action="heading-1" aria-label="Heading level 1">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M6.5 6.5v11m6-11v11m-6-5.5h6"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.7"
                  stroke-linecap="round"
                />
                <path
                  d="M17.5 9l2-1.2v9.7"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.7"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              <span class="toolbar-badge">1</span>
            </button>
            <button type="button" class="icon-button heading-button" data-action="heading-2" aria-label="Heading level 2">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M6.5 6.5v11m6-11v11m-6-5.5h6"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.7"
                  stroke-linecap="round"
                />
                <path
                  d="M16 10.2a2.6 2.6 0 012.6-2.7c1.4 0 2.4.9 2.4 2.1 0 1-.6 1.6-1.5 2.4l-2.6 2.2h4.1"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              <span class="toolbar-badge">2</span>
            </button>
            <button type="button" class="icon-button heading-button" data-action="heading-3" aria-label="Heading level 3">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M6.5 6.5v11m6-11v11m-6-5.5h6"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.7"
                  stroke-linecap="round"
                />
                <path
                  d="M16.5 10a2.4 2.4 0 012.4-2.5c1.2 0 2.1.8 2.1 1.9 0 .9-.5 1.5-1.3 1.8 1 .3 1.6 1.1 1.6 2.1 0 1.4-1.1 2.4-2.6 2.4-1.1 0-2-.6-2.5-1.5"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              <span class="toolbar-badge">3</span>
            </button>
            <button type="button" class="icon-button" data-action="link" aria-label="Insert link">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M9.5 14.5l-1.9 1.9a3 3 0 104.3 4.2l3.2-3.2a3 3 0 000-4.3l-.4-.4"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.6"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M14.5 9.5l1.9-1.9a3 3 0 00-4.3-4.3l-3.2 3.2a3 3 0 000 4.3l.4.4"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.6"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
            <button type="button" class="icon-button" data-action="image" aria-label="Insert image">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <rect
                  x="4"
                  y="5"
                  width="16"
                  height="14"
                  rx="2"
                  ry="2"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.6"
                />
                <circle cx="9" cy="10" r="1.6" fill="currentColor" />
                <path
                  d="M7 17l3.5-3.5 2.5 2.5 3.5-3.5 3 3.5"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.6"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
            <button type="button" class="icon-button" data-action="ordered-list" aria-label="Ordered list">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M10 7h9m-9 5h9m-9 5h9"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.6"
                  stroke-linecap="round"
                />
                <path
                  d="M5.5 6.5l-1.5.8M4 6.5v4.5m0 3h2.2L4 17.5h2.2"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.6"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
            <button type="button" class="icon-button" data-action="unordered-list" aria-label="Unordered list">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M10 7h9m-9 5h9m-9 5h9"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.6"
                  stroke-linecap="round"
                />
                <circle cx="6" cy="7" r="1.3" fill="currentColor" />
                <circle cx="6" cy="12" r="1.3" fill="currentColor" />
                <circle cx="6" cy="17" r="1.3" fill="currentColor" />
              </svg>
            </button>
            <button type="button" class="icon-button" data-action="table" aria-label="Insert table">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <rect
                  x="4"
                  y="5"
                  width="16"
                  height="14"
                  rx="2"
                  ry="2"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.6"
                />
                <path
                  d="M4 11h16M10 5v14M14 5v14"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.6"
                  stroke-linecap="round"
                />
              </svg>
            </button>
            <button type="button" class="icon-button" data-action="horizontal-rule" aria-label="Insert horizontal rule">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path d="M6 12h12" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" />
              </svg>
            </button>
            <button
              type="button"
              class="secondary-button mode-toggle"
              id="editor-mode-toggle"
              aria-pressed="false"
              aria-label="Switch to HTML mode"
              title="Switch to HTML mode"
            >
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M8 7l-4 5 4 5M16 7l4 5-4 5"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.6"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path d="M12 5v14" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" />
              </svg>
              <span class="button-label">HTML</span>
            </button>
          </div>
          <div class="toolbar toolbar-surface drive-actions" role="group" aria-label="Google Drive actions">
            <button type="button" class="secondary-button" id="drive-sign-in">Sign in</button>
            <button type="button" class="secondary-button" id="drive-sign-out" hidden>Sign out</button>
            <button type="button" class="secondary-button" id="drive-open" disabled>Open</button>
            <button type="button" class="primary" id="drive-save" disabled>Save</button>
            <button type="button" class="secondary-button" id="drive-save-as" disabled>Save as</button>
          </div>
        </div>
      </div>
    </header>
    <main>
      <div class="editor-container">
        <div class="editor-layout">
          <nav id="table-of-contents" class="toc" aria-label="Document outline">
            <div class="toc-header">
              <h2>Contents</h2>
            </div>
            <ol id="toc-list" class="toc-list" hidden></ol>
            <p id="toc-empty" class="toc-empty" hidden>Add headings to build a table of contents.</p>
          </nav>
          <div class="editor-content">
            <div class="file-title">
              <label class="visually-hidden" for="file-title-input">File title</label>
              <input
                type="text"
                id="file-title-input"
                name="file-title"
                autocomplete="off"
                placeholder="Untitled.md"
              />
            </div>
            <div class="editor-wrapper">
              <div class="editor-surface">
                <div
                  id="markdown-input"
                  class="editor"
                  contenteditable="true"
                  role="textbox"
                  aria-label="Markdown input"
                  spellcheck="true"
                ></div>
              </div>
            </div>
            <div class="status-bar">
              <div>
                <span>Words: <strong id="word-count">0</strong></span>
                <span>Characters: <strong id="char-count">0</strong></span>
              </div>
              <div>
                <span class="file-indicator" id="current-file">Untitled.md</span>
                <span id="drive-status"></span>
              </div>
            </div>
            <div id="status-message" role="status" aria-live="polite"></div>
          </div>
        </div>
      </div>
    </main>

    <div id="drive-dialog" role="dialog" aria-modal="true" aria-labelledby="drive-dialog-title">
      <div class="dialog-content">
        <div class="dialog-header">
          <h2 id="drive-dialog-title">Google Drive</h2>
          <button type="button" id="drive-dialog-close" aria-label="Close dialog">×</button>
        </div>
        <div class="dialog-body">
          <div id="drive-alert" class="alert" hidden></div>
          <p id="drive-config-status" class="dialog-description">
            Provide Google Drive credentials through your secure runtime configuration to enable Drive sync. For local
            development you can still supply a <code>google-oauth-client-id</code> meta tag value.
          </p>
          <div class="drive-controls">
            <div class="toolbar">
              <button type="button" id="drive-refresh-files" class="secondary-button">Refresh</button>
              <button type="button" id="drive-folder-up" class="secondary-button" disabled>Up one level</button>
            </div>
            <nav id="drive-breadcrumbs" class="drive-breadcrumbs" aria-label="Current folder"></nav>
          </div>
          <div class="drive-files" id="drive-files" hidden>
            <table>
              <thead>
                <tr>
                  <th>File</th>
                  <th>Modified</th>
                </tr>
              </thead>
              <tbody id="drive-files-body"></tbody>
            </table>
          </div>
          <div id="drive-save-controls" class="drive-save-controls" hidden>
            <label class="visually-hidden" for="drive-file-name">File name</label>
            <input type="text" id="drive-file-name" name="drive-file-name" placeholder="File name" autocomplete="off" />
            <button type="button" id="drive-save-confirm" class="primary">Save here</button>
          </div>
        </div>
        <div class="dialog-footer">
          <button type="button" id="drive-dialog-cancel">Close</button>
        </div>
      </div>
    </div>

    <script defer src="vendor/marked.min.js"></script>
    <script defer src="vendor/turndown.min.js"></script>
    <script defer src="vendor/turndown-plugin-gfm.min.js"></script>
    <script src="app.js" defer></script>
    <script
      defer
      src="https://accounts.google.com/gsi/client"
      onload="onGoogleAccountsLoaded()"
      onerror="console.error('Failed to load Google Identity Services script');"
    ></script>
    <script defer src="https://apis.google.com/js/api.js?onload=onGapiLoaded"></script>
  </body>
</html>
