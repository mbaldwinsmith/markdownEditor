<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Mark's Markdown Editor</title>
    <meta name="description" content="Progressive Web App Markdown editor with Google Drive sync." />
    <meta name="theme-color" content="#1f2937" />
    <meta name="google-oauth-client-id" content="220212893778-a2ja5dvu9tkp700it2819hc6iajvbgiu.apps.googleusercontent.com" />
    <link rel="manifest" href="manifest.json" />
    <link rel="icon" type="image/png" href="icons/icon-512.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
      integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header>
      <div class="inner">
        <div class="brand-row">
          <div class="app-brand">
            <span class="brand-mark" aria-hidden="true">
              <img src="icons/icon-1024.png" width="44" height="44" alt="" />
            </span>
            <h1>Mark's Markdown Editor</h1>
          </div>
          <button
            type="button"
            class="theme-toggle"
            id="theme-toggle"
            aria-pressed="false"
            aria-label="Switch to light mode"
            title="Switch to light mode"
          >
            <i class="fa-solid fa-moon theme-toggle-icon" aria-hidden="true"></i>
          </button>
        </div>
        <div class="toolbar-row">
          <button
            type="button"
            class="mobile-toolbar-toggle"
            id="mobile-toolbar-toggle"
            aria-expanded="false"
            aria-controls="formatting-toolbar"
          >
            <span class="mobile-toolbar-label">Show formatting</span>
            <i class="fa-solid fa-chevron-down mobile-toolbar-chevron" aria-hidden="true"></i>
          </button>
          <div
            class="toolbar toolbar-surface formatting"
            id="formatting-toolbar"
            role="toolbar"
            aria-label="Markdown formatting"
          >
            <div class="file-menu" id="file-menu">
              <button
                type="button"
                class="secondary-button file-menu-toggle"
                id="file-menu-toggle"
                aria-haspopup="true"
                aria-expanded="false"
                aria-controls="file-menu-dropdown"
                title="File actions"
              >
                <span class="file-menu-toggle-icon" aria-hidden="true">
                  <i class="fa-solid fa-bars"></i>
                </span>
                <span class="button-label">File</span>
                <i class="fa-solid fa-chevron-down file-menu-caret" aria-hidden="true"></i>
              </button>
            </div>
            <button
              type="button"
              class="icon-button"
              data-action="undo"
              aria-label="Undo"
              title="Undo"
              disabled
            >
              <i class="fa-solid fa-rotate-left" aria-hidden="true"></i>
            </button>
            <button
              type="button"
              class="icon-button"
              data-action="redo"
              aria-label="Redo"
              title="Redo"
              disabled
            >
              <i class="fa-solid fa-rotate-right" aria-hidden="true"></i>
            </button>
            <button type="button" class="icon-button" data-action="bold" aria-label="Bold">
              <i class="fa-solid fa-bold" aria-hidden="true"></i>
            </button>
            <button type="button" class="icon-button" data-action="italic" aria-label="Italic">
              <i class="fa-solid fa-italic" aria-hidden="true"></i>
            </button>
            <button type="button" class="icon-button" data-action="strikethrough" aria-label="Strikethrough">
              <i class="fa-solid fa-strikethrough" aria-hidden="true"></i>
            </button>
            <button type="button" class="icon-button" data-action="inline-code" aria-label="Inline code">
              <i class="fa-solid fa-code" aria-hidden="true"></i>
            </button>
            <button type="button" class="icon-button heading-button" data-action="heading-1" aria-label="Heading level 1">
              <span class="heading-icon" aria-hidden="true">H1</span>
            </button>
            <button type="button" class="icon-button heading-button" data-action="heading-2" aria-label="Heading level 2">
              <span class="heading-icon" aria-hidden="true">H2</span>
            </button>
            <button type="button" class="icon-button heading-button" data-action="heading-3" aria-label="Heading level 3">
              <span class="heading-icon" aria-hidden="true">H3</span>
            </button>
            <button type="button" class="icon-button" data-action="blockquote" aria-label="Block quote">
              <i class="fa-solid fa-quote-right" aria-hidden="true"></i>
            </button>
            <button type="button" class="icon-button" data-action="link" aria-label="Insert link">
              <i class="fa-solid fa-link" aria-hidden="true"></i>
            </button>
            <button type="button" class="icon-button" data-action="image" aria-label="Insert image">
              <i class="fa-solid fa-image" aria-hidden="true"></i>
            </button>
            <button type="button" class="icon-button" data-action="ordered-list" aria-label="Ordered list">
              <i class="fa-solid fa-list-ol" aria-hidden="true"></i>
            </button>
            <button type="button" class="icon-button" data-action="unordered-list" aria-label="Unordered list">
              <i class="fa-solid fa-list-ul" aria-hidden="true"></i>
            </button>
            <button type="button" class="icon-button" data-action="table" aria-label="Insert table">
              <i class="fa-solid fa-table" aria-hidden="true"></i>
            </button>
            <button type="button" class="icon-button" data-action="code-block" aria-label="Insert code block">
              <i class="fa-solid fa-file-code" aria-hidden="true"></i>
            </button>
            <button type="button" class="icon-button" data-action="horizontal-rule" aria-label="Insert horizontal rule">
              <i class="fa-solid fa-minus" aria-hidden="true"></i>
            </button>
            <button
              type="button"
              class="secondary-button mode-toggle"
              id="editor-mode-toggle"
              aria-pressed="false"
              aria-label="Switch to HTML mode"
              title="Switch to HTML mode"
            >
              <i class="fa-solid fa-code" aria-hidden="true"></i>
              <span class="button-label">HTML</span>
            </button>
          </div>
          <div
            class="toolbar toolbar-surface drive-actions file-menu-dropdown"
            id="file-menu-dropdown"
            role="menu"
            hidden
          >
            <div class="drive-menu-header">
              <div class="drive-menu-label" aria-hidden="true">
                <i class="fa-solid fa-folder-tree" aria-hidden="true"></i>
                <span>Files</span>
              </div>
            </div>
            <div class="drive-menu-grid" role="none">
              <button
                type="button"
                class="secondary-button drive-button"
                id="drive-sign-in"
                role="menuitem"
              >
                <span class="drive-icon" aria-hidden="true">
                  <i class="fa-brands fa-google-drive"></i>
                </span>
                <span class="button-label">Sign in</span>
              </button>
              <button
                type="button"
                class="secondary-button drive-button"
                id="drive-sign-out"
                role="menuitem"
                disabled
                aria-disabled="true"
              >
                <span class="drive-icon" aria-hidden="true">
                  <i class="fa-brands fa-google-drive"></i>
                </span>
                <span class="button-label">Sign out</span>
              </button>
              <button
                type="button"
                class="secondary-button drive-button"
                id="drive-open"
                role="menuitem"
                disabled
              >
                <span class="drive-icon" aria-hidden="true">
                  <i class="fa-solid fa-folder-open"></i>
                </span>
                <span class="button-label">Open</span>
              </button>
              <button
                type="button"
                class="primary drive-button"
                id="drive-save"
                role="menuitem"
                disabled
              >
                <span class="drive-icon" aria-hidden="true">
                  <i class="fa-solid fa-cloud-arrow-up"></i>
                </span>
                <span class="button-label">Save</span>
              </button>
              <button
                type="button"
                class="secondary-button drive-button"
                id="drive-save-as"
                role="menuitem"
                disabled
              >
                <span class="drive-icon" aria-hidden="true">
                  <i class="fa-solid fa-file-export"></i>
                </span>
                <span class="button-label">Save as</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </header>
    <main>
      <div class="editor-container">
        <div class="editor-layout">
          <nav id="table-of-contents" class="toc" aria-label="Document outline">
            <div class="toc-header">
              <h2>Contents</h2>
            </div>
            <ol id="toc-list" class="toc-list" hidden></ol>
            <p id="toc-empty" class="toc-empty" hidden>Add headings to build a table of contents.</p>
          </nav>
          <div class="editor-content">
            <div class="file-title">
              <label class="visually-hidden" for="file-title-input">File title</label>
              <input
                type="text"
                id="file-title-input"
                name="file-title"
                autocomplete="off"
                placeholder="Untitled.md"
              />
            </div>
            <div class="editor-wrapper">
              <div class="editor-surface">
                <div
                  id="markdown-input"
                  class="editor"
                  contenteditable="true"
                  role="textbox"
                  aria-label="Markdown input"
                  spellcheck="true"
                ></div>
              </div>
            </div>
            <div class="status-bar">
              <div>
                <span>Words: <strong id="word-count">0</strong></span>
                <span>Characters: <strong id="char-count">0</strong></span>
              </div>
              <div>
                <span class="file-indicator" id="current-file">Untitled.md</span>
                <span id="drive-status"></span>
              </div>
            </div>
            <div id="status-message" role="status" aria-live="polite"></div>
          </div>
        </div>
      </div>
    </main>

    <footer class="site-footer">
      <div class="inner">
        <p>© 2025 Mark's Markdown Editor.</p>
        <nav class="footer-nav" aria-label="Legal">
          <a href="privacy.html">Privacy Policy</a>
          <a href="terms.html">Terms of Service</a>
        </nav>
      </div>
    </footer>

    <div id="drive-dialog" role="dialog" aria-modal="true" aria-labelledby="drive-dialog-title">
      <div class="dialog-content">
        <div class="dialog-header">
          <h2 id="drive-dialog-title">Google Drive</h2>
          <button type="button" id="drive-dialog-close" aria-label="Close dialog">×</button>
        </div>
        <div class="dialog-body">
          <div id="drive-alert" class="alert" hidden></div>
          <div id="drive-config-status" class="cloud-config-card" role="status" aria-live="polite">
            <div class="cloud-card-icon" aria-hidden="true">
              <i class="fa-solid fa-cloud-bolt"></i>
            </div>
            <div class="cloud-card-content">
              <p class="cloud-card-eyebrow">Google Cloud setup</p>
              <h3 class="cloud-card-title">Connect your Drive credentials</h3>
              <p class="cloud-card-message">
                Provide Google Drive credentials through your secure runtime configuration to enable Drive sync. For local
                development you can still supply a <code>google-oauth-client-id</code> meta tag value.
              </p>
              <div class="cloud-card-links">
                <a
                  class="cloud-card-link"
                  href="https://console.cloud.google.com/"
                  target="_blank"
                  rel="noopener"
                >
                  <span>Open Google Cloud Console</span>
                  <i class="fa-solid fa-arrow-up-right-from-square" aria-hidden="true"></i>
                </a>
              </div>
            </div>
          </div>
          <div class="drive-controls">
            <div class="toolbar">
              <button type="button" id="drive-refresh-files" class="secondary-button">Refresh</button>
              <button type="button" id="drive-folder-up" class="secondary-button" disabled>Up one level</button>
            </div>
            <nav id="drive-breadcrumbs" class="drive-breadcrumbs" aria-label="Current folder"></nav>
          </div>
          <div class="drive-files" id="drive-files" hidden>
            <table>
              <thead>
                <tr>
                  <th>File</th>
                  <th>Modified</th>
                </tr>
              </thead>
              <tbody id="drive-files-body"></tbody>
            </table>
          </div>
          <div id="drive-save-controls" class="drive-save-controls" hidden>
            <label class="visually-hidden" for="drive-file-name">File name</label>
            <input type="text" id="drive-file-name" name="drive-file-name" placeholder="File name" autocomplete="off" />
            <button type="button" id="drive-save-confirm" class="primary">Save here</button>
          </div>
        </div>
        <div class="dialog-footer">
          <button type="button" id="drive-dialog-cancel">Close</button>
        </div>
      </div>
    </div>

    <script defer src="vendor/marked.min.js"></script>
    <script defer src="vendor/turndown.min.js"></script>
    <script defer src="vendor/turndown-plugin-gfm.min.js"></script>
    <script src="app.js" defer></script>
    <script
      defer
      src="https://accounts.google.com/gsi/client"
      onload="onGoogleAccountsLoaded()"
      onerror="console.error('Failed to load Google Identity Services script');"
    ></script>
    <script defer src="https://apis.google.com/js/api.js?onload=onGapiLoaded"></script>
  </body>
</html>
